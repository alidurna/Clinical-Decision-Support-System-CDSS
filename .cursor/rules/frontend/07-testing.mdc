---
description: Test kurallarÄ± â€” birim test, entegrasyon test, coverage, test yazÄ±m standartlarÄ± (Google 2026 Standards)
globs: apps/**/*.test.ts,apps/**/*.test.tsx,apps/**/*.spec.ts
alwaysApply: false
---

# ğŸ§ª Test KurallarÄ±

**Versiyon:** 2.0.0 â€” Google 2026 Standards
**Ã–ncelik:** ğŸŸ¡ P1 â€” YÃ¼ksek

---

## Genel Ä°lkeler

- Her bileÅŸen ve hook iÃ§in **en az 1 test dosyasÄ±**.
- Test dosyasÄ± bileÅŸenin yanÄ±nda: `Login.tsx` â†’ `Login.test.tsx`.
- Test isimleri **ne test ettiÄŸini** aÃ§Ä±kÃ§a anlatÄ±r.
- **DavranÄ±ÅŸ testi** Ã¶ncelikli; snapshot test minimum.

---

## Test YapÄ±sÄ±

```tsx
describe('Login', () => {
  // Setup
  beforeEach(() => {
    render(<Login />)
  })

  // Render testleri
  it('email ve ÅŸifre alanlarÄ±nÄ± render eder', () => {
    expect(screen.getByLabelText('Email')).toBeInTheDocument()
    expect(screen.getByLabelText('Åifre')).toBeInTheDocument()
  })

  // Validasyon testleri
  it('boÅŸ form gÃ¶nderildiÄŸinde hata gÃ¶sterir', async () => {
    await userEvent.click(screen.getByRole('button', { name: 'GiriÅŸ Yap' }))
    expect(screen.getByText('Email zorunludur')).toBeInTheDocument()
  })

  // BaÅŸarÄ±lÄ± senaryo
  it('baÅŸarÄ±lÄ± giriÅŸte dashboard sayfasÄ±na yÃ¶nlendirir', async () => {
    await userEvent.type(screen.getByLabelText('Email'), 'test@test.com')
    await userEvent.type(screen.getByLabelText('Åifre'), 'password123')
    await userEvent.click(screen.getByRole('button', { name: 'GiriÅŸ Yap' }))
    expect(mockNavigate).toHaveBeenCalledWith('/dashboard')
  })

  // Hata senaryosu
  it('baÅŸarÄ±sÄ±z giriÅŸte hata mesajÄ± gÃ¶sterir', async () => {
    server.use(rest.post('/api/auth/login', (_, res, ctx) => res(ctx.status(401))))
    await userEvent.click(screen.getByRole('button', { name: 'GiriÅŸ Yap' }))
    expect(screen.getByText('GiriÅŸ baÅŸarÄ±sÄ±z')).toBeInTheDocument()
  })
})
```

---

## Neyi Test Et

| Katman | Ne Test Edilir | AraÃ§ |
|--------|---------------|------|
| BileÅŸen | Render, kullanÄ±cÄ± etkileÅŸimi, state deÄŸiÅŸimi | React Testing Library |
| Hook | DÃ¶nÃ¼ÅŸ deÄŸerleri, state gÃ¼ncellemeleri | `renderHook` |
| API servis | Ä°stek/yanÄ±t, hata durumlarÄ± | msw (Mock Service Worker) |
| Form | Validasyon, submit, hata mesajlarÄ± | `userEvent` + `screen` |
| Router | Sayfa yÃ¶nlendirmeleri | MemoryRouter |
| Context | Provider deÄŸerleri, state paylaÅŸÄ±mÄ± | Custom wrapper |

---

## Test KurallarÄ±

1. **`data-testid`** kullan; CSS selector ile element seÃ§me.
2. **Mock:** API Ã§aÄŸrÄ±larÄ±nÄ± mock'la; gerÃ§ek backend'e istek **atma**.
3. **BaÄŸÄ±msÄ±zlÄ±k:** Her test baÄŸÄ±msÄ±z; test sÄ±rasÄ± sonucu **etkilememeli**.
4. **Snapshot minimum:** Snapshot yerine assertion kullan.
5. **Aria query'leri tercih et:** `getByRole`, `getByLabelText` > `getByTestId`.
6. **userEvent > fireEvent:** `userEvent` daha gerÃ§ekÃ§i etkileÅŸim simÃ¼lasyonu saÄŸlar.

---

## Coverage Hedefleri

| Metrik | Minimum | Hedef |
|--------|---------|-------|
| Statement | %60 | %80 |
| Branch | %50 | %70 |
| Function | %60 | %80 |
| Line | %60 | %80 |

- **Kritik bileÅŸenler** (auth, hasta) iÃ§in %90+ coverage hedefle.
- Coverage raporu CI/CD'de otomatik Ã¼retilir.

---

## Test Dosya Organizasyonu

```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ PatientCard.tsx
â”‚   â””â”€â”€ PatientCard.test.tsx     â† YanÄ±nda
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â””â”€â”€ useAuth.test.ts          â† YanÄ±nda
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ authService.ts
â”‚   â””â”€â”€ authService.test.ts      â† YanÄ±nda
â””â”€â”€ __mocks__/
    â””â”€â”€ handlers.ts              â† MSW handler'larÄ±
```
