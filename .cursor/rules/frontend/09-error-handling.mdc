---
description: Hata yÃ¶netimi kurallarÄ± â€” kullanÄ±cÄ± bildirimi, Error Boundary, fallback, loglama (Google 2026 Standards)
globs: apps/**/*.tsx,apps/**/*.ts
alwaysApply: false
---

# âš ï¸ Hata YÃ¶netimi

**Versiyon:** 2.0.0 â€” Google 2026 Standards
**Ã–ncelik:** ğŸ”´ P0 â€” Kritik

---

## KullanÄ±cÄ± Bildirimi

- Hata mesajÄ± **TÃ¼rkÃ§e**, **net** ve **aksiyon yÃ¶nlendirici**.
- Teknik detay kullanÄ±cÄ±ya **gÃ¶sterilmez** (`Error: ECONNREFUSED` yerine "BaÄŸlantÄ± saÄŸlanamadÄ±").
- Hata mesajlarÄ± yapÄ±cÄ± olmalÄ±: ne oldu + ne yapÄ±labilir.

| Durum | Mesaj Ã–rneÄŸi | BileÅŸen |
|-------|-------------|---------|
| Form validasyon | "Email formatÄ± geÃ§ersiz" | `helperText` |
| API hatasÄ± (400) | "Bilgilerinizi kontrol edin" | `Alert severity="error"` |
| Kimlik hatasÄ± (401) | "Oturum sÃ¼reniz doldu, lÃ¼tfen tekrar giriÅŸ yapÄ±n" | `Snackbar` + redirect |
| Yetki hatasÄ± (403) | "Bu iÅŸlem iÃ§in yetkiniz yok" | `Alert severity="warning"` |
| BulunamadÄ± (404) | "Ä°stenen kayÄ±t bulunamadÄ±" | Sayfa iÃ§i mesaj |
| Sunucu hatasÄ± (500) | "Bir hata oluÅŸtu, lÃ¼tfen tekrar deneyin" | `Snackbar` |
| AÄŸ hatasÄ± | "Ä°nternet baÄŸlantÄ±nÄ±zÄ± kontrol edin" | `Alert` |
| BoÅŸ veri | "HenÃ¼z kayÄ±t bulunmuyor" | Empty state bileÅŸeni |

---

## Error Boundary

### Zorunlu KullanÄ±m
- Her micro frontend kendi `ErrorBoundary` bileÅŸenini sarar.
- Shell'de genel `ErrorBoundary`; remote yÃ¼klenemezse fallback gÃ¶sterir.
- **Nested Error Boundary:** Sayfa > BÃ¶lÃ¼m > BileÅŸen seviyesinde.

```tsx
// App seviyesi
<ErrorBoundary fallback={<FullPageError />}>
  <Suspense fallback={<FullPageLoading />}>
    <App />
  </Suspense>
</ErrorBoundary>

// BileÅŸen seviyesi
<ErrorBoundary fallback={<Alert severity="error">Bu bÃ¶lÃ¼m yÃ¼klenemedi.</Alert>}>
  <Suspense fallback={<Skeleton variant="rectangular" height={200} />}>
    <RemoteComponent />
  </Suspense>
</ErrorBoundary>
```

### Error Boundary BileÅŸeni
```tsx
class ErrorBoundary extends React.Component<Props, State> {
  state = { hasError: false, error: null }
  
  static getDerivedStateFromError(error: Error) {
    return { hasError: true, error }
  }
  
  componentDidCatch(error: Error, info: React.ErrorInfo) {
    // Hata raporlama servisi (Sentry vb.)
    logErrorToService(error, info.componentStack)
  }
  
  render() {
    if (this.state.hasError) {
      return this.props.fallback || <DefaultErrorUI />
    }
    return this.props.children
  }
}
```

---

## Loading States (Zorunlu)

| Durum | GÃ¶ster |
|-------|--------|
| Sayfa yÃ¼kleniyor | `CircularProgress` veya tam sayfa Skeleton |
| BÃ¶lÃ¼m yÃ¼kleniyor | `Skeleton` (rectangular/text/circular) |
| Buton iÅŸleniyor | `disabled` + spinner |
| Liste yÃ¼kleniyor | Skeleton x3 satÄ±r |
| Form gÃ¶nderiliyor | Buton disabled + "GÃ¶nderiliyor..." |

---

## Loglama KurallarÄ±

| Ortam | YÃ¶ntem |
|-------|--------|
| GeliÅŸtirme | `console.error` (sadece gerÃ§ek hatalar) |
| Staging | Log servisi (Sentry vb.) |
| Ãœretim | Log servisi + alert sistemi |

### Yasak Loglama
- âŒ KullanÄ±cÄ± verisini (ÅŸifre, TC, telefon) **asla** loglama.
- âŒ `catch (e) {}` â€” BoÅŸ catch bloÄŸu **yasak**.
- âŒ `console.log` ile hata yÃ¶netimi.
- âŒ Stack trace'i kullanÄ±cÄ±ya gÃ¶sterme.

### DoÄŸru Loglama
```tsx
try {
  await apiCall()
} catch (error) {
  // âœ… Hata servisine raporla
  logError(error, { context: 'PatientList.fetchPatients' })
  
  // âœ… KullanÄ±cÄ±ya anlamlÄ± mesaj gÃ¶ster
  setError('Hasta listesi yÃ¼klenemedi. LÃ¼tfen tekrar deneyin.')
}
```

---

## Form Hata YÃ¶netimi

```tsx
// âœ… DOÄRU â€” Alan bazlÄ± hata
<TextField
  label="Email"
  error={!!errors.email}
  helperText={errors.email?.message}
  required
/>

// âœ… DOÄRU â€” Form dÃ¼zeyinde hata
{formError && (
  <Alert severity="error" sx={{ mb: 2 }}>
    {formError}
  </Alert>
)}
```
